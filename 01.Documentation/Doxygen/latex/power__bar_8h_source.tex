\hypertarget{power__bar_8h_source}{}\doxysection{power\+\_\+bar.\+h}
\label{power__bar_8h_source}\index{C:/Users/Javi/Team Dropbox/Javi Rodriguez/Workspace/2-\/PROYECTOS/Bitbucket/03-\/Battery Pack/bat\_sw/LIBRARIES/0006-\/POWERBAR/power\_bar.h@{C:/Users/Javi/Team Dropbox/Javi Rodriguez/Workspace/2-\/PROYECTOS/Bitbucket/03-\/Battery Pack/bat\_sw/LIBRARIES/0006-\/POWERBAR/power\_bar.h}}
\mbox{\hyperlink{power__bar_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00001}00001 }
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00012}00012 \textcolor{comment}{//\#include <Adafruit\_IS31FL3731.h>}}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00013}00013 \textcolor{comment}{//\#include <display.h>}}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00014}00014 \textcolor{comment}{//\#include <MilliTimer.h>}}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00015}\mbox{\hyperlink{power__bar_8h_a0283d6e8b7a6f074221f9ed20c72b110}{00015}} \textcolor{keyword}{const} int16\_t \mbox{\hyperlink{power__bar_8h_a0283d6e8b7a6f074221f9ed20c72b110}{MAX\_POWER\_DISPLAYED}} = 2500;}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00016}\mbox{\hyperlink{power__bar_8h_a7aa6fb846ca0660bc618f3aa59842e78}{00016}} \textcolor{keyword}{const} int16\_t \mbox{\hyperlink{power__bar_8h_a7aa6fb846ca0660bc618f3aa59842e78}{LEDS\_IN\_POWERBAR}} = 15;}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00017}00017 }
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00018}\mbox{\hyperlink{power__bar_8h_a29cfc14ebcf8488409fbb9d1abc2af02}{00018}} \textcolor{keyword}{const} int16\_t \mbox{\hyperlink{power__bar_8h_a29cfc14ebcf8488409fbb9d1abc2af02}{power\_by\_led}} = \mbox{\hyperlink{power__bar_8h_a0283d6e8b7a6f074221f9ed20c72b110}{MAX\_POWER\_DISPLAYED}} / \mbox{\hyperlink{power__bar_8h_a7aa6fb846ca0660bc618f3aa59842e78}{LEDS\_IN\_POWERBAR}};}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00019}00019 }
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00020}\mbox{\hyperlink{power__bar_8h_ad6b28b233a1dbd3301129be731cf276a}{00020}} \mbox{\hyperlink{class_milli_timer}{MilliTimer}} \mbox{\hyperlink{power__bar_8h_ad6b28b233a1dbd3301129be731cf276a}{refresh\_timer}};}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00021}00021 }
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00022}\mbox{\hyperlink{power__bar_8h_a44952b05fbd77dbb964abea1a508c8d0}{00022}} \textcolor{keywordtype}{void} \mbox{\hyperlink{power__bar_8h_a44952b05fbd77dbb964abea1a508c8d0}{PowerBar}}(int16\_t leds, \mbox{\hyperlink{class_adafruit___i_s31_f_l3731___wing}{Adafruit\_IS31FL3731\_Wing}} \mbox{\hyperlink{_b1_8ino_ad7d1ac2604db2782f2973047258604ee}{ledmatrix}}, \textcolor{keywordtype}{bool} mode\_bright = \mbox{\hyperlink{display_8h_a5d90f2891b15cb085b544c8c7a03b813}{C\_MODE\_HIGH\_BRIGHT}})}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00030}00030 \{}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00031}00031     leds = constrain(leds, 0, \mbox{\hyperlink{power__bar_8h_a7aa6fb846ca0660bc618f3aa59842e78}{LEDS\_IN\_POWERBAR}});}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00032}00032     \textcolor{keywordflow}{if} (mode\_bright == \mbox{\hyperlink{display_8h_a5d90f2891b15cb085b544c8c7a03b813}{C\_MODE\_HIGH\_BRIGHT}})}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00033}00033     \{}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00034}00034         \mbox{\hyperlink{display_8h_a652f5dd24e2b6135dca2b356e99a4bd2}{C\_DISPLAY\_ON}} = \mbox{\hyperlink{display_8h_a6e1253cca08f3f94feaf9770af6b6a9e}{C\_HIGH\_BRIGHTNESS}};}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00035}00035     \}}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00036}00036     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mode\_bright == \mbox{\hyperlink{display_8h_a308ce306c360e273e64f874bb7641394}{C\_MODE\_LOW\_BRIGHT}})}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00037}00037     \{}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00038}00038         \mbox{\hyperlink{display_8h_a652f5dd24e2b6135dca2b356e99a4bd2}{C\_DISPLAY\_ON}} = \mbox{\hyperlink{display_8h_aef2aa50b26eedaac6e025b94203b9572}{C\_LOW\_BRIGHTNESS}};}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00039}00039     \}}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00040}00040     \textcolor{keywordflow}{if} (leds == 0)}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00041}00041     \{}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00042}00042         \mbox{\hyperlink{_b1_8ino_ad7d1ac2604db2782f2973047258604ee}{ledmatrix}}.\mbox{\hyperlink{class_adafruit___g_f_x_a4d42e7cc577c1eb5b06fe656786c9c79}{drawFastHLine}}(0, \mbox{\hyperlink{display_8h_aefbf190d109598ef359d888e66e55129}{C\_PWBAR\_Y\_AXE}}, \mbox{\hyperlink{power__bar_8h_a7aa6fb846ca0660bc618f3aa59842e78}{LEDS\_IN\_POWERBAR}}, \mbox{\hyperlink{display_8h_a18ac02c662caedd6c7d39a6c2773d9ca}{C\_DISPLAY\_OFF}});}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00043}00043     \}}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00044}00044     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00045}00045     \{}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00047}00047         \textcolor{keywordflow}{for} (int16\_t \mbox{\hyperlink{0003-_b_u_z_z_e_r_2examples_2_t_e_s_t__0_2_t_e_s_t__0_8ino_a752abcfe7ce5874cd9e8012a0346a37b}{i}} = 0; \mbox{\hyperlink{0003-_b_u_z_z_e_r_2examples_2_t_e_s_t__0_2_t_e_s_t__0_8ino_a752abcfe7ce5874cd9e8012a0346a37b}{i}} <= leds; \mbox{\hyperlink{0003-_b_u_z_z_e_r_2examples_2_t_e_s_t__0_2_t_e_s_t__0_8ino_a752abcfe7ce5874cd9e8012a0346a37b}{i}}++)}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00048}00048         \{}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00049}00049             \mbox{\hyperlink{_b1_8ino_ad7d1ac2604db2782f2973047258604ee}{ledmatrix}}.\mbox{\hyperlink{class_adafruit___i_s31_f_l3731___wing_a92d3cbc7273f5dfa682dc439c1d8564e}{drawPixel}}(\mbox{\hyperlink{0003-_b_u_z_z_e_r_2examples_2_t_e_s_t__0_2_t_e_s_t__0_8ino_a752abcfe7ce5874cd9e8012a0346a37b}{i}}, \mbox{\hyperlink{display_8h_aefbf190d109598ef359d888e66e55129}{C\_PWBAR\_Y\_AXE}}, \mbox{\hyperlink{display_8h_a652f5dd24e2b6135dca2b356e99a4bd2}{C\_DISPLAY\_ON}});}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00050}00050         \}}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00051}00051         \textcolor{keywordflow}{for} (int16\_t \mbox{\hyperlink{0003-_b_u_z_z_e_r_2examples_2_t_e_s_t__0_2_t_e_s_t__0_8ino_a752abcfe7ce5874cd9e8012a0346a37b}{i}} = leds; \mbox{\hyperlink{0003-_b_u_z_z_e_r_2examples_2_t_e_s_t__0_2_t_e_s_t__0_8ino_a752abcfe7ce5874cd9e8012a0346a37b}{i}} < \mbox{\hyperlink{power__bar_8h_a7aa6fb846ca0660bc618f3aa59842e78}{LEDS\_IN\_POWERBAR}}; \mbox{\hyperlink{0003-_b_u_z_z_e_r_2examples_2_t_e_s_t__0_2_t_e_s_t__0_8ino_a752abcfe7ce5874cd9e8012a0346a37b}{i}}++)}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00052}00052         \{}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00053}00053             \mbox{\hyperlink{_b1_8ino_ad7d1ac2604db2782f2973047258604ee}{ledmatrix}}.\mbox{\hyperlink{class_adafruit___i_s31_f_l3731___wing_a92d3cbc7273f5dfa682dc439c1d8564e}{drawPixel}}(\mbox{\hyperlink{0003-_b_u_z_z_e_r_2examples_2_t_e_s_t__0_2_t_e_s_t__0_8ino_a752abcfe7ce5874cd9e8012a0346a37b}{i}}, \mbox{\hyperlink{display_8h_aefbf190d109598ef359d888e66e55129}{C\_PWBAR\_Y\_AXE}}, \mbox{\hyperlink{display_8h_a18ac02c662caedd6c7d39a6c2773d9ca}{C\_DISPLAY\_OFF}});}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00054}00054         \}}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00055}00055     \}}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00056}00056 \}}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00064}\mbox{\hyperlink{power__bar_8h_a9e86607753b82e90e7ed88d54fa86c6c}{00064}} \textcolor{keywordtype}{void} \mbox{\hyperlink{power__bar_8h_a9e86607753b82e90e7ed88d54fa86c6c}{UpdatePowerBar}}(int16\_t power\_sample, \mbox{\hyperlink{class_adafruit___i_s31_f_l3731___wing}{Adafruit\_IS31FL3731\_Wing}} \mbox{\hyperlink{_b1_8ino_ad7d1ac2604db2782f2973047258604ee}{ledmatrix}}, \textcolor{keywordtype}{bool} \mbox{\hyperlink{_b1_8ino_a92af24f114daa3e7144daa46081d8f4c}{mode\_bright\_display}})}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00065}00065 \{}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00066}00066     \textcolor{keyword}{static} int16\_t high\_sample = 0;}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00068}00068     \textcolor{keywordflow}{if} (high\_sample < power\_sample)}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00069}00069     \{}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00070}00070         high\_sample = power\_sample;}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00071}00071     \}}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00073}00073     \textcolor{keywordflow}{if} (\mbox{\hyperlink{power__bar_8h_ad6b28b233a1dbd3301129be731cf276a}{refresh\_timer}}.\mbox{\hyperlink{class_milli_timer_a7db6330ee7f1551b88a324fce593f8aa}{poll}}(50) != \mbox{\hyperlink{_milli_timer_8h_a2b52d1ddc05fa2d9212ee51ca4cde653}{C\_TIMER\_NOT\_EXPIRED}})}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00074}00074     \{}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00075}00075         uint16\_t num\_leds = (high\_sample + (\mbox{\hyperlink{power__bar_8h_a29cfc14ebcf8488409fbb9d1abc2af02}{power\_by\_led}} / 2)) / \mbox{\hyperlink{power__bar_8h_a29cfc14ebcf8488409fbb9d1abc2af02}{power\_by\_led}};}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00076}00076         \mbox{\hyperlink{power__bar_8h_a44952b05fbd77dbb964abea1a508c8d0}{PowerBar}}(num\_leds, \mbox{\hyperlink{_b1_8ino_ad7d1ac2604db2782f2973047258604ee}{ledmatrix}}, \mbox{\hyperlink{_b1_8ino_a92af24f114daa3e7144daa46081d8f4c}{mode\_bright\_display}});}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00077}00077         high\_sample = 0;}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00078}00078     \}}
\DoxyCodeLine{\Hypertarget{power__bar_8h_source_l00079}00079 \}}

\end{DoxyCode}
